{% load widget_tweaks %}
<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Search</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css">
	<link href='https://fonts.googleapis.com/css?family=Lato:300,400,400italic,700,700italic' rel='stylesheet'>
	<style>
		*,
		*:before,
		*:after {
			box-sizing: border-box;
			font-size: 20px;
			margin: 0.5rem;
		}

		.container {
			position: relative;
			margin-bottom: 16px;
			/* line-height: 0; */
		}

		.container--flex {
			display: flex;
		}


		@media (min-width: 1200px) {
			.container {
				width: 95%;
			}
		}

		body {
			
			font-family: Arial, Helvetica;
		}

		.select-container {
			/* margin: 2rem; */
			text-align: center;
		}

		.big {
			font-size: 1.2em;
		}

		.square {
			width: .7em;
			height: .7em;
			margin: .5em;
			display: inline-block;
		}

		/* Custom dropdown */

		.custom-dropdown {
			position: relative;
			display: inline-block;
			vertical-align: middle;
			margin: 10px;
			/* demo only */
		}

		.custom-dropdown select {
			background-color: #000;
			color: #fff;
			font-size: inherit;
			padding: .5em;
			padding-right: 2.5em;
			border: 0;
			margin: 0;
			border-radius: 3px;
			text-indent: 0.01px;
			text-overflow: '';
			-webkit-appearance: button;
			/* hide default arrow in chrome OSX */
		}

		.custom-dropdown::before,
		.custom-dropdown::after {
			content: "";
			position: absolute;
			pointer-events: none;
		}

		.custom-dropdown::after {
			/*  Custom dropdown arrow */
			content: "\25BC";
			height: 1em;
			font-size: .625em;
			line-height: 1;
			right: 1.2em;
			top: 50%;
			margin-top: -.5em;
		}

		.custom-dropdown::before {
			/*  Custom dropdown arrow cover */
			width: 2em;
			right: 0;
			top: 0;
			bottom: 0;
			border-radius: 0 3px 3px 0;
		}

		.custom-dropdown select[disabled] {
			color: rgba(0, 0, 0, .3);
		}

		.custom-dropdown select[disabled]::after {
			color: rgba(0, 0, 0, .1);
		}

		.custom-dropdown::before {
			background-color: rgba(0, 0, 0, .15);
		}

		.custom-dropdown::after {
			color: rgba(0, 0, 0, .4);
		}
	</style>
</head>

<body>

	<div class="select-container">
		<span class="custom-dropdown big">
			<select id="cluster">
				<option value="All">All Clusters</option>
				{% for cluster_data in cluster_data %}
				<option value="{{cluster_data.cluster_id}}">{{ cluster_data.cluster_name }}</option>
				{% empty %}
				<option value="">------------</option>
				{% endfor %}
			</select>
		</span>

		<span class="custom-dropdown big">
			<select id="project">
				<option value="All">All Projects</option>
				{% for project_data in project_data %}
				<option value="{{project_data.project_id}}">{{ project_data.project_name }}</option>
				{% empty %}
				<option value="">------------</option>
				{% endfor %}
			</select>
		</span>

		<span class="custom-dropdown big">
			<select id="module">
				<option value="All">All Module</option>
				{% for module_data in module_data %}
				<option value="{{module_data.module_id}}">{{ module_data.module_name }}</option>
				{% empty %}
				<option value="">------------</option>
				{% endfor %}
			</select>
		</span>
	</div>
	<div class="container">
		<div class="row table-responsive">
			<table class="table table-striped table-bordered" style="width:100%" id="dataTable" data-order='[[ 0, "asc" ]]' data-page-length='5'>
				<thead>
					<tr>
						<th>error_id</th>
						<th>error_name</th>
						<th>error_description</th>
						<th>error_mitigation</th>
						<th>screenshot_link</th>
						<th>author</th>
						<th>error_validated</th>
						<th>error_validator</th>
						<th>editors_list</th>
					</tr>
				</thead>
				<tbody>
					{% for error_data in error_data %}
					<tr>
						<td id="error_id">{{ error_data.error_id }}</td>
						<td id="error_name">{{ error_data.error_name }}</td>
						<td id="error_description">{{ error_data.error_description }}</td>
						<td id="error_mitigation">{{ error_data.error_mitigation }}</td>
						{% if error_data.link_valid == True %}
						<td id="screenshot_link">
							<a href="{{ error_data.screenshot_link }}" target="_blank">link_{{error_data.error_id}}</a>
						</td>
						{% else %}
						<td id="screenshot_link">{{ error_data.screenshot_link }}</td>
						{% endif %}
						<td id="author">{{ error_data.author }}</td>
						<td id="error_validated">{{ error_data.error_validated }}</td>
						<td id="error_validator">{{ error_data.error_validator }}</td>
						<td id="editors_list">{{ error_data.editors_list }}</td>
					</tr>
					{% endfor %}
				</tbody>
				<tfoot>
					<th>error_id</th>
					<th>error_name</th>
					<th>error_description</th>
					<th>error_mitigation</th>
					<th>screenshot_link</th>
					<th>author</th>
					<th>error_validated</th>
					<th>error_validator</th>
					<th>editors_list</th>
				</tfoot>
			</table>
		</div>
	</div>
	<script src='https://code.jquery.com/jquery-3.3.1.js'></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js'></script>
	<script src='https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js'></script>
	<script>
		// advanced search modal
		$(document).ready(function () {
			// table pagination
			$('#dataTable').DataTable({
				"pagingType": "full_numbers",
			});
			// Setup - add a text input to each footer cell
			$('#dataTable tfoot th').each(function () {
				var title = $(this).text();
				$(this).html('<input type="text" placeholder="Search ' + title + '" />');
			});

			// DataTable
			var table = $('#dataTable').DataTable();

			// Apply the search
			table.columns().every(function () {
				var that = this;

				$('input', this.footer()).on('keyup change', function () {
					if (that.search() !== this.value) {
						that
							.search(this.value)
							.draw();
					}
				});
			});
			$('#cluster').change(function() {
				if (this.value === "All") {
				table
					.columns(0)
					.search('')
					.draw();
				} else {
				table
					.columns(0)
					.search(this.value)
					.draw();
				}
			});
			$('#project').change(function() {
				if (this.value === "All") {
				table
					.columns(0)
					.search('')
					.draw();
				} else {
				table
					.columns(0)
					.search(this.value)
					.draw();
				}
			});
			$('#module').change(function() {
				if (this.value === "All") {
				table
					.columns(0)
					.search('')
					.draw();
				} else {
				table
					.columns(0)
					.search(this.value)
					.draw();
				}
			});


		});
	</script>
</body>

</html>